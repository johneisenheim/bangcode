function Motion(){function e(e){if(e.success){var t=e.userAcceleration;Math.abs(a-t.x)>s&&o++,Math.abs(lastY-t.y)>s&&accelY++,Math.abs(lastZ-t.z)>s&&accelZ++,i(),a=t.x,lastY=t.y,lastZ=t.z;var r=e.attitude;u&&(r.pitch>=-2.25&&r.pitch<-.25&&r.roll>=.9&&r.roll<2.5?(Ti.API.info("Starting position!"),Ti.App.fireEvent("position",{what:!0})):(Ti.API.info("No starting position"),Ti.App.fireEvent("position",{what:!1}))),n.imInStarting?r.pitch>=-.4&&r.pitch<.4&&r.roll>=1.2&&r.roll<1.7&&(r.yaw>=.8&&r.yaw<1.5?(Ti.API.info("Here I am "+r.yaw+" beetwen :"+d-.3+" "+d+.8),l?(Ti.API.info("Bang!"),m.play(),Ti.API.info("ACCELERAZIONE: "+a+" "+lastY+" "+lastZ),Ti.API.info(r.yaw+" con yaw di riferimento "+d+" e differenza "+(d-.3)+" "+(d+.8)),n.imInStarting=!1,c=!1,n.stopMotionRecognizer(),endTime=new Date,diffTime=endTime-startTime,Ti.API.info("Tempo inizio: "+startTime+"; tempo fine: "+endTime+"; diff: "+diffTime),Ti.App.fireEvent("timeExchange",{flag:0,acceleration:lastY})):(Ti.API.info("Fault!"),p.play(),Ti.App.fireEvent("fault",{}),l=!1,n.imInStarting=!1,c=!1,Ti.API.info(r.yaw+" con yaw di riferimento "+d+" e differenza "+(d-.3)+" "+(d+.8)),n.stopMotionRecognizer(),endTime=new Date,diffTime=endTime-startTime,Ti.API.info("Tempo inizio: "+startTime+"; tempo fine: "+endTime+"; diff: "+diffTime),Ti.App.fireEvent("timeExchange",{flag:88888888,acceleration:lastY}))):(f.play(),Ti.API.info("Missed!"),n.imInStarting=!1,c=!1,Ti.API.info(r.yaw+" con yaw di riferimento "+d+" e differenza "+(d-.3)+" "+(d+.8)),endTime=new Date,diffTime=endTime-startTime,Ti.API.info("Tempo inizio: "+startTime+"; tempo fine: "+endTime+"; diff: "+diffTime),n.stopMotionRecognizer(),Ti.App.fireEvent("timeExchange",{flag:999999999,acceleration:lastY}))):Ti.API.info("im in starting Ã¨ false"),c||(d=r.yaw)}else e.error&&Ti.API.error(e.error)}function i(){if(o>r||accelY>r||accelZ>r){o>r&&accelY>r?(Ti.API.info("Quit shaking me back and forth!"),Ti.API.info(accelZ)):o>r&&accelZ>r?Ti.API.info("Quit shaking me up and down!"):accelZ>r&&accelY>r&&Ti.API.info("Why are you shaking me like that?!"),o=accelY=accelZ=0}}var t=require("ti.coremotion"),n={},o=accelY=accelZ=0,a=lastY=lastZ=0,s=1,r=1;n.imInStarting=!1;var c=!1,d=0,l=!1,u=!0,m=ZLSound.createSample({media:"music/colt_shot.mp3",volume:1}),f=ZLSound.createSample({media:"music/missed.mp3",volume:1}),p=ZLSound.createSample({media:"music/fault.mp3",volume:1});return n.startMotionRecognizer=function(){if(t.isDeviceMotionAvailable()){t.setDeviceMotionUpdateInterval(200);var i=t.availableAttitudeReferenceFrames(),n=t.ATTITUDE_REFERENCE_FRAME_X_ARBITRARY_CORRECTED_Z_VERTICAL;i&n?(Ti.API.info("REFERENCE FRAME: True North"),t.startDeviceMotionUpdatesUsingReferenceFrame({referenceFrame:n},e)):(n=t.getAttitudeReferenceFrame())?(Ti.API.info("REFERENCE FRAME: Default "+n),t.startDeviceMotionUpdatesUsingReferenceFrame({referenceFrame:n},e)):(Ti.API.info("REFERENCE FRAME: None"),t.startDeviceMotionUpdates(e))}},n.stopMotionRecognizer=function(){t.stopDeviceMotionUpdates(),Ti.API.info("Motion updates stop")},Ti.App.addEventListener("user_can_fire",function(){l=!0,u=!1}),n}module.exports=Motion;