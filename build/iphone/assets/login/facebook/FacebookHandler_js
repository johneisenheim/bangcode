function FacebookHandler(){var e={},n=require("com.facebook");n.permissions=["public_profile","user_friends","email"];var i=Ti.Network.createHTTPClient({onload:function(){Ti.API.info("Received text: "+this.responseText),global.startApplication()},onerror:function(e){Ti.API.debug(e.error)},timeout:5e3});return n.addEventListener("login",function(e){e.success?(Ti.API.info("login success: "+JSON.stringify(e.data)),Titanium.App.Properties.setBool("user_logged",1),Titanium.App.Properties.setString("fb_id",e.data.id),Titanium.App.Properties.setString("fb_last_name",e.data.last_name),Titanium.App.Properties.setString("fb_first_name",e.data.fb_first_name),Titanium.App.Properties.setString("fb_mail",e.data.email),Ti.API.info("Actual permissions: "+JSON.stringify(n.permissions)),Ti.API.info(global.bangServerUrl+"/registerUser.php?user_account="+JSON.stringify(e.data)),i.open("GET",global.bangServerUrl+"/registerUser.php?user_account="+JSON.stringify(e.data)),i.send()):e.cancelled?Ti.API.info("login cancelled"):e.error&&Ti.API.info(e.error)}),n.addEventListener("logout",function(e){Ti.API.info(JSON.stringify(e))}),e.logMeIn=function(){n.authorize()},e.getInvitableFriends=function(){n.requestWithGraphPath("me/friends",{},"GET",function(e){alert(e.success?e.result:e.error?e.error:"Unknown response")})},n.initialize(6e3,!0),e.logMeOut=function(){n.logout()},e}module.exports=FacebookHandler;