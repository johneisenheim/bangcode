function QuickGameFinder(){function e(){setInterval(function(){return 0==a?(Ti.API.info("countdown BANG!"),d.stop(),s.play(),void Ti.App.fireEvent("user_can_fire",{})):(a-=1,void e())},1e3)}var t=null,i=null,o="notready",n=0,a=0,r=require("ui/quickGame/QuickGameFinderView"),l=new r,s=ZLSound.createSample({media:"music/churchbell.mp3",volume:1}),d=ZLSound.createSample({media:"music/tic.mp3",volume:1}),u=Titanium.UI.createWindow({navTintColor:"white",tintColor:"#E2BB5A",barColor:"#E2BB5A",extendEdges:[Ti.UI.EXTEND_EDGE_TOP],backgroundColor:"#F5F4F2",translucent:!0,statusBarStyle:Titanium.UI.iPhone.StatusBar.GRAY,layout:"composite",tabBarHidden:!0,modal:!0,orientationModes:[1]}),c=Titanium.UI.createLabel({top:"55%",font:{fontSize:18,fontFamily:"Roboto-LightItalic"},text:"Controllo Bluetooth...",textAlign:"center",color:"#aa938b",width:"95%"}),h=Titanium.UI.createButton({title:"Chiudi",font:{fontSize:19},color:"#856C64",top:20,right:15}),g=Ti.UI.createAlertDialog({ok:"Okay",title:"Bang!"});loader.showLoader(u);var T=function(){t=require("com.pj"),i=t.createSession();i.checkBluetoothAccess();i.addEventListener("bluetoothState",function(e){switch(e.state){case"The connection with the system service was momentarily lost, update imminent.":break;case"The platform doesn't support Bluetooth Low Energy.":g.message="Il tuo dispositivo non supporta il bluetooth 4.0. Bang! non può funzionare su questi dispositivi.",g.show(),c.text="Bluetooth non supportato.",t=null,i=null;break;case"The app is not authorized to use Bluetooth Low Energy.":g.message="Non hai autorizzato Bang! a poter utilizzare il bluetooth.",g.show(),c.text="Bluetooth non autorizzato.",t=null,i=null;break;case"Bluetooth is currently powered off.":g.message="Il Bluetooth è spento! Per favore, accedi alle impostazioni e attivalo.",g.show(),c.text="Il Bluetooth è spento.";break;case"Bluetooth is currently powered on and available to use.":c.text="Ricerco la partita...",i.setupSessionAndStartServices(Ti.App.Properties.getString("fb_id"),"",0)}}),i.addEventListener("didReceiveInvitationFromPeer",function(){c.text="Ho trovato la partita!Preparo il gioco..."}),i.addEventListener("connecting",function(){c.text="Connetto allo sfidante..."}),i.addEventListener("connected",function(){c.text="Connesso! Iniziamo...",setTimeout(function(){loader.hideLoader(u),u.remove(c),u.add(l)},2e3)}),i.addEventListener("notConnected",function(){Ti.API.info("Ho lanciato il notConnected")}),i.addEventListener("didReceiveData",function(t){var r=t.message.split(":");switch(r[0]){case"tellme":o=l.getMyOwnStatus()?"ready":"notready",Ti.API.info("[INFO] Sending "+o),i.sendData(o+":");break;case"start":a=3+n,Ti.API.info("[INFO] Counter is "+a),e(),d.play();break;case"random":n=r[1]}})};return u.addEventListener("open",T),h.addEventListener("click",function(){t=null,i=null,u.close()}),u.add(c),u.add(h),u}module.exports=QuickGameFinder;