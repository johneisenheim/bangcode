function QuickGameFinder(){function e(){0==r?(Ti.API.info("countdown BANG!"),u.stop(),d.play(),Ti.App.fireEvent("user_can_fire",{}),clearInterval(interval)):(Ti.API.info(r),r-=1)}function t(){interval=setTimeout(function(){Ti.API.info("called startCountdown"),e()},1e3)}var i=null,o=null,n="notready",a=0,r=0,l=require("ui/quickGame/QuickGameFinderView"),s=new l,d=ZLSound.createSample({media:"music/bell.mp3",volume:1}),u=ZLSound.createSample({media:"music/tic.mp3",volume:1}),c=Titanium.UI.createWindow({navTintColor:"white",tintColor:"#E2BB5A",barColor:"#E2BB5A",extendEdges:[Ti.UI.EXTEND_EDGE_TOP],backgroundColor:"#F5F4F2",translucent:!0,statusBarStyle:Titanium.UI.iPhone.StatusBar.GRAY,layout:"composite",tabBarHidden:!0,modal:!0,orientationModes:[1]}),h=Titanium.UI.createLabel({top:"55%",font:{fontSize:18,fontFamily:"Roboto-LightItalic"},text:"Controllo Bluetooth...",textAlign:"center",color:"#aa938b",width:"95%"}),g=Titanium.UI.createButton({title:"Chiudi",font:{fontSize:19},color:"#856C64",top:20,right:15}),T=Ti.UI.createAlertDialog({ok:"Okay",title:"Bang!"});loader.showLoader(c);var m=function(){i=require("com.pj"),o=i.createSession();o.checkBluetoothAccess();o.addEventListener("bluetoothState",function(e){switch(e.state){case"The connection with the system service was momentarily lost, update imminent.":break;case"The platform doesn't support Bluetooth Low Energy.":T.message="Il tuo dispositivo non supporta il bluetooth 4.0. Bang! non può funzionare su questi dispositivi.",T.show(),h.text="Bluetooth non supportato.",i=null,o=null;break;case"The app is not authorized to use Bluetooth Low Energy.":T.message="Non hai autorizzato Bang! a poter utilizzare il bluetooth.",T.show(),h.text="Bluetooth non autorizzato.",i=null,o=null;break;case"Bluetooth is currently powered off.":T.message="Il Bluetooth è spento! Per favore, accedi alle impostazioni e attivalo.",T.show(),h.text="Il Bluetooth è spento.";break;case"Bluetooth is currently powered on and available to use.":h.text="Ricerco la partita...",o.setupSessionAndStartServices(Ti.App.Properties.getString("fb_id"),"",0)}}),o.addEventListener("didReceiveInvitationFromPeer",function(){h.text="Ho trovato la partita!Preparo il gioco..."}),o.addEventListener("connecting",function(){h.text="Connetto allo sfidante..."}),o.addEventListener("connected",function(){h.text="Connesso! Iniziamo...",setTimeout(function(){loader.hideLoader(c),c.remove(h),c.add(s)},2e3)}),o.addEventListener("notConnected",function(){Ti.API.info("Ho lanciato il notConnected")}),o.addEventListener("didReceiveData",function(e){var i=e.message.split(":");switch(i[0]){case"tellme":n=s.getMyOwnStatus()?"ready":"notready",Ti.API.info("[INFO] Sending "+n),o.sendData(n+":");break;case"start":r=3+a,Ti.API.info("[INFO] Counter is "+r),t(),u.play();break;case"random":a=i[1]}})};return c.addEventListener("open",m),g.addEventListener("click",function(){i=null,o=null,c.close()}),c.add(h),c.add(g),c}module.exports=QuickGameFinder;