function QuickGame(){function e(){setInterval(function(){return 0==a?(Ti.API.info("countdown BANG!"),s.stop(),l.play(),void Ti.App.fireEvent("user_can_fire",{})):(a-=1,void e())},1e3)}var t=require("com.pj"),i=null,o=require("ui/quickGame/QuickGameView"),n=new o,a=0,r=Math.floor(4*Math.random()+1),l=ZLSound.createSample({media:"music/churchbell.mp3",volume:1}),s=ZLSound.createSample({media:"music/tic.mp3",volume:1}),d=0,u=Titanium.UI.createWindow({navTintColor:"white",tintColor:"#E2BB5A",barColor:"#E2BB5A",extendEdges:[Ti.UI.EXTEND_EDGE_TOP],backgroundColor:"#F5F4F2",translucent:!0,statusBarStyle:Titanium.UI.iPhone.StatusBar.GRAY,layout:"composite",tabBarHidden:!0,modal:!0,orientationModes:[1]}),c=Titanium.UI.createLabel({top:"55%",font:{fontSize:17,fontFamily:"Roboto-LightItalic"},text:"Cerco l'avversario...",textAlign:"center",color:"#aa938b",width:"95%"});loader.showLoader(u);var h=function(){Ti.API.info("initQuickGameCallback"),i=t.createSession();i.checkBluetoothAccess();i.addEventListener("bluetoothState",function(e){switch(e.state){case"The connection with the system service was momentarily lost, update imminent.":break;case"The platform doesn't support Bluetooth Low Energy.":dialog.message="Il tuo dispositivo non supporta il bluetooth 4.0. Bang! non può funzionare su questi dispositivi.",dialog.show(),c.text="Bluetooth non supportato.",t=null,i=null;break;case"The app is not authorized to use Bluetooth Low Energy.":dialog.message="Non hai autorizzato Bang! a poter utilizzare il bluetooth.",dialog.show(),c.text="Bluetooth non autorizzato.",t=null,i=null;break;case"Bluetooth is currently powered off.":dialog.message="Il Bluetooth è spento! Per favore, accedi alle impostazioni e attivalo.",dialog.show(),c.text="Il Bluetooth è spento.";break;case"Bluetooth is currently powered on and available to use.":c.text="Ricerco l'avversario...",Ti.API.info(d),i.setupSessionAndStartServices(Ti.App.Properties.getString("fb_id"),d,1)}}),i.addEventListener("connecting",function(){c.text="Connetto allo sfidante..."}),i.addEventListener("connected",function(){c.text="Connesso! Iniziamo...",setTimeout(function(){loader.hideLoader(u),u.remove(c),u.add(n),i.sendData("tellme:"),i.sendData("random:"+r)},2e3)}),i.addEventListener("notConnected",function(){i.tryToReconnect(Ti.App.Properties.getString("fb_id"),d,1)}),i.addEventListener("didReceiveData",function(t){var o=t.message.split(":");switch(Ti.API.info("[INFO] RECEIVED MESSAGE : "+o[0]),o[0]){case"notready":i.sendData("tellme:");break;case"ready":n.flag?(i.sendData("start:"),a=3+r,setTimeout(function(){s.play(),e()},100)):i.sendData("tellme:")}})};return u.setIDOpponent=function(e){Ti.API.info("Opponent ID is "+e),d=e},u.addEventListener("open",h),u.add(c),u}module.exports=QuickGame;